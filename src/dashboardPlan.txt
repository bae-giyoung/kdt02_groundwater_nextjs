======= 대시보드 1차 작업분(제한사항: 7일 예측 모델이 나오기 전 제출용) 리뷰/보강 조언 =======

[활용할 수 있는 데이터 목록]
1. OPEN API: 12개 관측소별 일별 평균 데이터(한 번 요청에 하나의 관측소만 조회 가능 => Next서버 앱라우터로 엔드포인트 만들어서 해결했음(12번 fetch의 결과를 하나의 JSON 데이터로 가공해서 클라이언트로 전달, 파이프라인: 클라이언트 요청(1번)->Next서버에서 OPEN API에 fetch 12번->클라이언트에서 응답반음(1번)))
2. DB 기상요인 원천데이터: 2014~2023년의 실측 기상(강수량, 기온 등) 데이터(시간별)
3. DB 지하수위 원천데이터: 2014~2023년의 실측 지하수위 데이터(시간별)
4. DB 지하수위 예측데이터: 예측(2021~2023년, 3년치) 지하수위 데이터
5. DB 관측소별 평가지표 데이터: 12개 관측소별 테스트 데이터(2021~2023년)의 모델 평가 지표
6. 정적 파일: RandomForest로 뽑아낸 특성중요도(특성공학한) csv파일
7. 정적 파일 통계데이터: 기상 민감 관측소 Top5/ 강수민감 관측소 Top5/ RMSE 상위 관측소 Top5(데이터 분석/모델 개발 담당 팀원이 통계낼 예정인 데이터)


[현재 대시보드 1차 컨텐츠 + 부가 기능(+예정) 목록]
= 대시보드 컨텐츠 =
1. (전체)전체 12개 관측소 지하수위 현황(일평균/7일평균/14일평균/30일평균 셀렉트)
2. (전체)전국 대표 관측망(12개 관측소) 지도: mappoint 호버시 해당 관측소 mappoint의 지하수위 현황(일평균/7일평균/14일평균/30일평균) 간단한 툴팁이 나타남
3. (관측소별)(관측소 선택/defalut선택 관측소 있음) 해당 관측소 정보
4. (관측소별) 해당 관측소 데이터 성능 지표(NSE/KGE/RMSE). 테스트 데이터(2021~2023, 3년치)를 통해 낸 지표. 이름을 해당 관측소의 모델 성능 지표로 바꿀까?
5. (관측소별) 장기 추세 그래프(2014~2023) 지난 10년간 월별 평균 지하수위 추이(실측 10년과, 예측 3년도 함께 시각화)
6. (관측소별) 기상-수위 상관관계 그래프(2021~2023). 7번과 일맥상통하나.
7. (관측소별) 주요 영향 변수 분석. 6번과 일맥상통하나.
8. (전체)통계분석: 기상 민감 관측소 Top5/ 강수민감 관측소 Top5/ RMSE 상위 관측소 Top5

= 부가 기능 =
1. 전체 대시보드 이미지/이미지PDF 다운로드 기능 (전체 페이지 다운로드 기능을 css로 깨지는것 맞추기 번거로워서 안함)
2. 각 라인차트(장기 추세 그래프, 기상-수위 상관관계 그래프), 파이 차트(특성중요도(주요 영향변수 분석))의 Highcharts.js에서 제공하는 메뉴버튼 클릭: 
   이미지로 다운로드(완료) / csv 또는 xml파일로 다운로드(예정) / 크게 보기(예정) / 차트 인쇄(예정)
3. 기간/관측소 선택 셀렉트박스(스크롤시 따라다니는 사이드 네비게이션 박스), 관측망 지도의 mappoint클릭시 관측소 선택과 동일한 동작
4. (숨겨진)대시보드 데이터 설명: 왼쪽 최하단의 물음표 아이콘 호버시 나타는 숨은 설명 박스
5. (숨겨진)각 지표 카드의 아이콘 클릭시 나타나는 지표설명 모달창(미니)
6. 장기 추세 그래프 zoom기능(1년/3년/7년/10년)


[추가 고려중인 사항]
1. 장기 추세 그래프 옆에 3년 예측 기간의 "예측 지하수위" 요약 테이블: 통계적으로 집계해서 아주 작게 만들려면 내용을 어떻게 구성해야 하나?
2. 장기 추세 그래프 오른쪽 밑에 3년 예측 기간의 "실측 기상요인" 요약 테이블: 마찬가지로 작게 만들려는데 연/분기/월 평균?????
3. 7일 예측 모델이 만들어지면: 지도 오른쪽 섹션(선택된 관측소 영역)의 데이터 성능 지표 위에 해당 관측소의 7일 예측 테이블 또는 작은 그래프? 삽입할 예정




========= 개선 제안 ========
🔹 1. 방향
→ 다음과 같이 “맥락+메시지+데이터 해석”을 덧입히면 훨씬 설득력 있는 리서치형 대시보드로 바뀝니다.

🔹 2. 콘텐츠 측면 보강 제안
구역	현재 기능	보강 제안	이유
상단(전국 현황표)	단순 수치 요약	✅ “전년 대비 증감(▲/▼)” 또는 “평균대비 편차(±%)” 컬럼 추가	단순 수치 나열보다 “변화 방향”이 보여야 트렌드 감이 생김
지도(전국 대표 관측망)	시각적 중심 우수	✅ 범례(정상/주의/위험 색상 기준) 표시
✅ Hover 시 ‘최근 30일 평균 수위 + 예측 추세 화살표’ 표시	시각적 맥락 강화로 “현재 상태 + 미래 방향성”을 동시에 전달
관측소 정보 카드	잘 구성되어 있음	✅ ‘AI 예측 신뢰도’(KGE 기반) 등급 배지 추가	AI 모델 결과에 대한 신뢰성 지표로서 “정량적 설득력” 강화
데이터 성능 지표	NSE/KGE/RMSE 표시	✅ 각 지표의 색상 변화 (좋음=파랑, 보통=회색, 낮음=주황)
✅ 지표별 기준 범례(0~1척도) 추가	비전문가도 쉽게 이해할 수 있도록 시각화 기준 제공
장기 추세 그래프	실측/예측 구간 잘 분리됨	✅ 예측 구간에 “음영 영역 + ‘예측구간(2021~2023)’ 텍스트”
✅ 평균선(dashed baseline) 추가	예측 구간이 한눈에 보이고, 전체 흐름 대비 차이가 드러남
기상-수위 상관관계 그래프	시각적으로 매끄러움	✅ correlation coefficient(R²=0.82 등) 표시
✅ 주요 변수 선택 버튼 (강수/기온/습도 등 토글)	분석 신뢰성과 유연한 탐색성 향상
주요 영향 변수 분석	Pie 차트	✅ 변수별 단위 표시(mm, ℃, hPa 등)
✅ “해당 변수는 지하수 변동에 28% 기여” 문구 추가	단순 비율 이상으로 “해석 가능한 스토리” 제공
하단 통계 Top5	직관적 카드 구성	✅ Top5간 비교 막대(Trend bar, ↑↓ 등)
✅ “강수 민감도 변화량(전년 대비)” 표시	통계 카드가 단순 순위표가 아닌 “추세 해석형”으로 진화


🔹 3. 그래프/수치 표현 측면 보강
120포인트 이상의 데이터에서 모든 수치를 노출하는 것은 부담스럽지만,
**“맥락을 알려주는 지표”**는 반드시 포함하는 것이 좋습니다.

장기 추세 그래프
→ x축 상단에 “평균 수위선 (105m)” 점선 추가
→ hover tooltip에 “편차율(%)” 표시 (ex: +3.2%)

기상 상관 그래프
→ 좌상단에 “상관계수 R²”
→ tooltip: 2022-07 | 강수량 45mm | 지하수위 102.3m

Pie 차트 (특성 중요도)
→ 상단에 “AI가 중요하게 본 변수 상위 3개” 부제목
→ hover tooltip에 변수명+기여율+단위 함께 표시


🔹 4. 문장 추가 여부 (설명문 vs 대시보드)
대시보드의 본질은 “설명문보다 시각으로 말하게 하는 것”입니다.
따라서 긴 설명문은 불필요하지만, 다음 두 가지는 짧은 텍스트로 꼭 보강하는 것이 좋습니다:

✅ 상단 인트로 (현재 빠짐)

“이 대시보드는 2014~2023년 기상자료를 기반으로 AI 모델이 예측한 지하수위 변동을 시각화합니다.
관측소별 변화 추세와 주요 기상 요인을 함께 탐색할 수 있습니다.”

✅ 하단 출처 및 모델명

데이터 출처: 국가지하수정보센터(GIMS), 기상청(ASOS)
모델: LSTM 기반 시계열 예측 (2021–2023년 테스트)

→ 글자 크기는 작게, 하지만 존재만으로 신뢰도를 크게 높입니다.


🔹 5. 대시보드의 “큰 맥락” — 지금 보이는가?
지금 대시보드는 기능적으로 훌륭하지만, 보는 사람 입장에서는 다음 세 질문이 떠오릅니다:

1️⃣ “현재 우리나라 지하수는 어떤 상태인가?”
2️⃣ “어떤 지역이 위험하거나 변화가 큰가?”
3️⃣ “왜 이런 변화가 생겼는가?”

→ 즉, ‘현황 → 원인 → 대응’이라는 **이야기 흐름(storyline)**이 필요합니다.
이 흐름을 자연스럽게 보이게 하려면 아래 식의 시각적 구조가 좋습니다:

[전국 현황] → [관측소 상세] → [변화 추세] → [영향 요인] → [요약 통계]


현재 이미 이 구조가 거의 완성되어 있으므로,
섹션 제목만 명확히 보이게(글자 크기·간격·아이콘) 하면 스토리라인이 자동으로 드러납니다.


🔹 6. 추가 아이디어 (세부 요소)
장기 추세 그래프 오른쪽에 작은 요약 테이블

예측 구간 평균: 104.7m
최대/최소: 108.1 / 101.2
예측 변화율: -2.7%


→ 그래프 맥락을 숫자로 요약해주는 역할

상관관계 그래프 아래에 작은 문구

“강수량이 증가할수록 지하수위도 약 0.8의 상관성을 보입니다.”

하단 Top5 카드 상단에 작은 부제

“최근 3년(2021–2023) 기준 통계”


✅ 결론 요약
항목	현재 수준	개선 포인트
정보 구조	이미 계층형으로 잘 구성됨	상단→중간→하단의 흐름을 더 명확히
시각화 해석력	우수하지만 수치 기반 해석 부족	예측구간 음영, 상관계수, 편차선 추가
문장 설명	다소 부족	상단 소개 2줄, 하단 출처 문구 추가
스토리라인	암시적	“현황→추세→원인→요약” 흐름 강화
복잡도	적절함	유지하되 구역 간 여백/섹션 타이틀 강화




================= 대시보드 개선 구조 다이어그램 =================

📊 **지하수위 예측 대시보드 개선 구조 다이어그램 (Storyline Flow + 시각 구성 제안)**

---

### 🧭 전체 시각적 흐름 (Storyline Flow)

```
[1️⃣ 전국 현황 요약] → [2️⃣ 관측소 상세 정보] → [3️⃣ 장기 추세 분석] → [4️⃣ 기상요인 상관 분석] → [5️⃣ 주요 영향요인 분석] → [6️⃣ 종합 통계 요약]
```

이 흐름을 통해 사용자가 **‘전국의 큰 그림 → 지역별 특징 → 변화 원인 → 요약 결론’**으로 자연스럽게 탐색하게 함.

---

### 🧩 시각적 구성 제안

| 섹션                  | 주요 콘텐츠                            | 시각화 요소                  | 설명 강화 포인트                                                        |
| ------------------- | --------------------------------- | ----------------------- | ---------------------------------------------------------------- |
| **① 전국 현황**         | 전국 대표 관측소 지하수위 지도 + 현황표           | 🗺️ 버블맵 + 수위 요약 테이블     | - 범례(정상/주의/위험)<br>- 전년 대비 증감 표시<br>- Hover시 최근 수위 + 예측추세 화살표     |
| **② 관측소 상세 정보**     | 선택 관측소의 메타정보 + 성능지표               | 📋 카드형 정보 + 게이지차트       | - KGE 기반 “모델 신뢰도” 배지 추가<br>- 각 지표별 색상 구간 기준 표시                   |
| **③ 장기 추세 그래프**     | 2014–2023 실측 + 2021–2023 예측       | 📈 라인차트 (실측=실선 / 예측=점선) | - 예측 구간 음영 + ‘예측구간’ 텍스트<br>- 평균선(105m) 추가<br>- 편차율 표시 (+3.2%)    |
| **④ 기상-수위 상관관계**    | 기상변수별 상관 그래프                      | 📊 라인 + 산점 그래프          | - 상관계수(R²=0.82) 표기<br>- 변수 토글 버튼(강수/기온 등)<br>- Tooltip: 날짜·변수·수위 |
| **⑤ 주요 영향 변수 분석**   | 특성 중요도 분석 (AI Feature Importance) | 🥧 파이차트 / 막대차트          | - 단위(mm, °C 등) 표기<br>- 상위 3개 변수 강조<br>- "AI가 중요하게 본 요인" 부제 추가    |
| **⑥ 종합 통계 요약 (하단)** | Top5 요약 통계 (가뭄 안정/강수 민감/RMSE)     | 🧾 카드 + Trend bar       | - 변화율 표시 (▲/▼)<br>- 부제: "최근 3년(2021–2023) 기준"                    |

---

### 🎯 시각적 강조 포인트

* **색상 계열:** 실측(파랑) / 예측(주황) / 위험(적색) 일관 유지
* **그래프 내 해석선:** 평균선·예측구간 음영·편차율 점선 추가
* **텍스트:**

  * 상단: "AI 기반 지하수위 변동 시각화 대시보드"
  * 하단: "데이터 출처: GIMS, KMA | 모델: LSTM (2021–2023)"
* **여백 배치:** 각 섹션 간 명확한 간격 + 소제목 아이콘 📊 📍 🧠 등으로 구분

---

### 📈 개선 효과 요약

| 항목      | 현재       | 개선 후 효과                  |
| ------- | -------- | ------------------------ |
| 정보 구조   | 단순 기능 나열 | ‘현황 → 원인 → 해석’ 스토리로 변환   |
| 시각 해석력  | 수치 중심    | 맥락(추세, 상관, 중요도) 중심 해석 가능 |
| 시각적 집중도 | 동일 시각톤   | 색·음영·범례로 가시성 강화          |
| 설득력     | 부분적      | 데이터-이유-결론이 한눈에 보임        |

---

### 📘 추가 권장 요소 (옵션)

* 📄 **요약 테이블:** 예측 구간 평균/최대/최소/변화율
* 🔍 **Tooltip 해석 문장:** “강수량 증가 → 수위 +0.8 상관성”
* 📚 **모달/도움말:** NSE/KGE/RMSE 정의

---

**최종 구조 도식:**

```
┌──────────────────────────────────────────┐
│ [전국 현황]                              │
│  ↓                                        │
│ [관측소 상세정보 + 성능지표]             │
│  ↓                                        │
│ [장기 추세 그래프]                       │
│  ↓                                        │
│ [기상요인 상관분석]                      │
│  ↓                                        │
│ [AI 영향요인 분석]                        │
│  ↓                                        │
│ [Top5 통계 요약 + 출처/모델정보]          │
└──────────────────────────────────────────┘
```




================= 컬러 팔레트 모음 ======================
["#E8F5E9", "#DDEFE0", "#C8E0C9", "#D6ECEA"];
// ["#F4E3C2", "#E3D4B9", "#D6C4A0", "#C5B59C", "#B3A58B", "#9F9982"]
// ["#E1F5FE", "#B3E5FC", "#A5D6F9", "#81C6EA", "#6BAEDB"]
// ["#E8F5E9", "#C8E6C9", "#A5D6A7", "#B2DFDB", "#80CBC4"]
// ["#F2F8F3", "#DDEFE0", "#C8E0C9", "#D6ECEA", "#A9D5D1"]