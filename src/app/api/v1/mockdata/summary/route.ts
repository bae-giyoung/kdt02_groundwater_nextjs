import { NextResponse, NextRequest } from "next/server";

// [백엔트 URL - 3년 예측 요약(월별)]
// http://10.125.121.211:8080/api/v1/rawdata/summary/predict?station=1&timestep=monthly&horizons=36


const mockData1 = `
{
  "table": {
    "table_data_3y": [
      [1, 202210, 105.52356, 105.52806, 0.0045],
      [1, 202211, 105.34889, 105.34706, 0.00183],
      [1, 202212, 105.22437, 105.21767, 0.0067],
      [1, 202301, 105.19151, 105.18313, 0.00838],
      [1, 202302, 105.14629, 105.13758, 0.00871],
      [1, 202303, 105.15216, 105.14237, 0.00979],
      [1, 202304, 105.23515, 105.22404, 0.01111],
      [1, 202305, 105.53776, 105.53333, 0.00443],
      [1, 202306, 105.72078, 105.72236, 0.00158],
      [1, 202307, 106.15873, 106.16094, 0.00221],
      [1, 202308, 105.96557, 105.96907, 0.0035],
      [1, 202309, 105.92297, 105.9276, 0.00463],
      [1, 202310, 105.62127, 105.62489, 0.00362],
      [1, 202311, 105.51768, 105.52138, 0.0037],
      [1, 202312, 105.55457, 105.55545, 0.00088]
    ],
    "columns": [
      "관측소",
      "관측 월/관측 년도",
      "실측값",
      "예측값",
      "오차 평균"
    ]
  },
  "metrics": {
    "RMSE": 0.075748354,
    "R2": 0.92311292886734,
    "KGE": 0.916392163649712,
    "NSE": 0.92311292886734
  }
}
`;

const mockData2 = `
{
  "table": {
    "table_data_3y": [
      [1, 202210, 105.52356, 105.52806, 0.0045],
      [1, 202211, 105.34889, 105.34706, 0.00183],
      [1, 202212, 105.22437, 105.21767, 0.0067],
      [1, 202301, 105.19151, 105.18313, 0.00838],
      [1, 202302, 105.14629, 105.13758, 0.00871],
      [1, 202303, 105.15216, 105.14237, 0.00979],
      [1, 202304, 105.23515, 105.22404, 0.01111],
      [1, 202305, 105.53776, 105.53333, 0.00443],
      [1, 202306, 105.72078, 105.72236, 0.00158],
      [1, 202307, 106.15873, 106.16094, 0.00221],
      [1, 202308, 105.96557, 105.96907, 0.0035],
      [1, 202309, 105.92297, 105.9276, 0.00463],
      [1, 202310, 105.62127, 105.62489, 0.00362],
      [1, 202311, 105.51768, 105.52138, 0.0037],
      [1, 202312, 105.55457, 105.55545, 0.00088]
    ],
    "columns": [
      "관측소",
      "관측 월/관측 년도",
      "실측값",
      "예측값",
      "오차 평균"
    ]
  },
  "metrics": {
    "RMSE": 0.075748354,
    "R2": 0.92311292886734,
    "KGE": 0.916392163649712,
    "NSE": 0.92311292886734
  }
}
`;

//?station=1&timestep=monthly&horizons=36
function getSearchParams(request: NextRequest) {
    const params = request.nextUrl.searchParams;
    const station = params.get("station") ?? "1";
    const timestep = params.get("timestep") ?? "monthly";
    const horizons = params.get("horizons") ?? "36";
    return { station, timestep, horizons }
}

export async function GET(
    request : NextRequest
) {
    const { station, timestep, horizons } = getSearchParams(request);

    const data = Number(station) % 2 == 0 ? JSON.parse(mockData2) : JSON.parse(mockData1);

    return NextResponse.json(data);
}